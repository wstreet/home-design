{"version":3,"sources":["Edit2D/index.jsx","Left/index.jsx","App.js","index.js"],"names":["Edit","autobind","props","edit2dRef","React","createRef","resources","Loader","shared","pointerDownTarget","pointerStart","Point","pointerDiffStart","diffX","diffY","add","load","this","init","width","window","innerWidth","height","innerHeight","uniforms","uResolution","x","y","app","view","style","initUniforms","initApp","initBackground","initEvents","ticker","uPointerDiff","Application","current","transparent","backgroundColor","renderer","autoDensity","stageFsh","data","stageFilter","Filter","undefined","stage","filters","background","Sprite","backgroundFsh","backgroundFilter","addChild","addEventListener","onResize","oncontextmenu","e","wheelDelta","uGridUnit","interactive","on","onPointerDown","onPointerUp","onPointerMove","uPointerDown","global","set","clone","handleCursor","cursor","id","ref","Component","LeftMenu","onSelect","key","setState","state","menus","icon","HomeOutlined","name","SettingOutlined","AppstoreOutlined","className","map","menu","onClick","Header","Layout","App","mode","defaultSelectedKeys","i","Item","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.57ac102a.chunk.js","sourcesContent":["import React from 'react';\nimport { Application, Graphics, Loader, Sprite, Filter, Point } from 'pixi.js'\nimport { autobind } from 'core-decorators'\nimport './index.css'\n/**\n * 参考\n * https://css-tricks.com/building-an-images-gallery-using-pixijs-and-webgl/\n */\n\n@autobind\nclass Edit extends React.Component {\n  constructor(props) {\n    super(props)\n    this.edit2dRef = React.createRef()\n\n    this.resources = Loader.shared.resources\n    this.pointerDownTarget = 0\n\n    this.pointerStart = new Point()\n    this.pointerDiffStart = new Point()\n    this.diffX = 0\n    this.diffY = 0\n  }\n  \n  componentDidMount() {\n    Loader.shared\n    .add('backgroundFsh', 'shaders/background.fsh')\n    .add('stageFsh', 'shaders/stage.fsh')\n    .load(this.init)\n  }\n\n  onResize() {\n    const width =window.innerWidth\n    const height = window.innerHeight\n\n    // 更新uniforms网格宽高\n    this.uniforms.uResolution.x = width\n    this.uniforms.uResolution.y = height\n\n    this.app.view.width = width\n    this.app.view.height = height\n\n    this.app.view.style.width = width + 'px'\n    this.app.view.style.height = height + 'px'\n  }\n\n\n  init() {\n    this.initUniforms()\n    this.initApp()\n    this.initBackground()\n    this.initEvents()\n\n    this.app.ticker.add(() => {\n      // Multiply the values by a coefficient to get a smooth animation\n      this.uniforms.uPointerDiff.x += (this.diffX - this.uniforms.uPointerDiff.x) * 0.2\n      this.uniforms.uPointerDiff.y += (this.diffY - this.uniforms.uPointerDiff.y) * 0.2\n    })\n  }\n\n  initApp() {\n    const width = window.innerWidth\n    const height = window.innerHeight\n    this.app = new Application({\n      view: this.edit2dRef.current,\n      width,\n      height,\n      transparent: true,\n      backgroundColor: 0xf0f0f0\n    })\n\n    this.app.renderer.autoDensity = true\n\n    const stageFsh = this.resources['stageFsh'].data\n    const stageFilter = new Filter(undefined, stageFsh, this.uniforms)\n    this.app.stage.filters = [stageFilter]\n  }\n\n  initBackground() {\n    // Create a new empty Sprite and define its size\n    const background = new Sprite()\n    background.width = window.innerWidth\n    background.height = window.innerHeight\n    // Get the code for the fragment shader from the loaded resources\n    const backgroundFsh = this.resources['backgroundFsh'].data\n    // Create a new Filter using the fragment shader\n    // We don't need a custom vertex shader, so we set it as `undefined`\n    const backgroundFilter = new Filter(undefined, backgroundFsh, this.uniforms)\n    // Assign the filter to the background Sprite\n    background.filters = [backgroundFilter]\n    // Add the background to the stage\n    this.app.stage.addChild(background)\n\n    this.background = background\n\n  }\n\n  initEvents() {\n    window.addEventListener('resize', this.onResize)\n\n    // TODO: 禁止canvas的contextmenu ... addEventListener没生效\n    this.app.view.oncontextmenu = (e) => {\n      return false\n    }\n\n    // 缩放事件\n    this.app.view.addEventListener('wheel', e => {\n      const { wheelDelta } = e\n      \n      // 缩小\n      if (wheelDelta > 0) {\n        this.uniforms.uGridUnit += 1.0\n      } else { // 放大\n        this.uniforms.uGridUnit -= 1.0\n      }\n      // if (this.uniforms.uGridUnit >= 100.0) {\n      //   this.uniforms.uGridUnit = 100.0\n      // }\n      // if (this.uniforms.uGridUnit <= 10.0) {\n      //   this.uniforms.uGridUnit = 10.0\n      // }\n    })\n\n    this.app.stage.interactive = true\n\n    // Pointer & touch events are normalized into\n    // the `pointer*` events for handling different events\n    this.app.stage\n    .on('pointerdown', this.onPointerDown)\n    .on('pointerup', this.onPointerUp)\n    .on('pointerupoutside', this.onPointerUp)\n    .on('pointermove', this.onPointerMove)\n  }\n\n  initUniforms() {\n    const width =window.innerWidth\n    const height = window.innerHeight\n    this.uniforms = {\n      uResolution: new Point(width, height),\n      uPointerDiff: new Point(),\n      uPointerDown: this.pointerDownTarget,\n      uGridUnit: 50.0\n    }\n  }\n\n  onPointerDown(e) {\n    const { x, y } = e.data.global\n    this.pointerDownTarget = 1\n    this.pointerStart.set(x, y)\n    this.pointerDiffStart = this.uniforms.uPointerDiff.clone()\n\n    this.handleCursor()\n  }\n\n  onPointerUp() {\n    this.pointerDownTarget = 0\n\n    this.handleCursor()\n  }\n\n  onPointerMove(e) {\n    const { x, y } = e.data.global\n    if (this.pointerDownTarget) {\n      this.diffX = this.pointerDiffStart.x + (x - this.pointerStart.x)\n      this.diffY = this.pointerDiffStart.y + (y - this.pointerStart.y)\n    }\n  }\n\n  handleCursor() {\n    if (this.pointerDownTarget) {\n      this.app.stage.cursor = 'grabbing'\n    } else {\n      this.app.stage.cursor = 'default'\n    }\n  }\n\n\n  render() {\n    return (\n      <canvas id=\"edit2d\" ref={this.edit2dRef}></canvas>\n    )\n  }\n}\n\nexport default Edit;","import React from 'react';\nimport { HomeOutlined, AppstoreOutlined, SettingOutlined } from '@ant-design/icons'\nimport './index.css'\n\nclass LeftMenu extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      menus: [\n        {\n          icon: <HomeOutlined />,\n          name: '画户型',\n          key: 'home'\n        },\n        {\n          icon: <SettingOutlined />,\n          name: '做定制',\n          key: 'setting'\n        },\n        {\n          icon: <AppstoreOutlined />,\n          name: '样板间',\n          key: 'models'\n        },\n      ],\n      current: 'home'\n    }\n  }\n  \n  componentDidMount() {\n   \n  }\n\n  onSelect = (key) => {\n    return () => {\n      this.setState({\n        current: key\n      })\n    }\n  }\n\n\n  render() {\n    const {current, menus} = this.state\n    return (\n      <ul className=\"left-menu-container\" >\n        {\n          menus.map(menu => {\n            return (\n              <li\n                key={menu.key} \n                className={`menu-item${menu.key === current? ' menu-item-active':''}`}\n                onClick={this.onSelect(menu.key)}\n              >\n                <div className=\"menu-icon\">{menu.icon}</div>\n                <div className=\"menu-name\">{menu.name}</div>\n              </li>\n            )\n          })\n        }\n      </ul>\n    )\n  }\n}\n\nexport default LeftMenu;","import React from 'react';\nimport { Layout, Menu, Popover, Button } from 'antd';\nimport Edit2D from './Edit2D'\nimport Left from './Left'\nimport './App.css';\n\nconst { Header } = Layout;\n\n\nconst App = () => {\n  return (\n    <Layout>\n      <Header className=\"header\">\n        <h1 className=\"logo\" >设计家</h1>\n        <Menu mode=\"horizontal\" defaultSelectedKeys={['2']} className=\"tool_bar\">\n          {\n            [1, 2, 3].map(i => <Menu.Item className=\"tool_item\" key={i}>{`nav ${i}`}</Menu.Item>)\n          }\n        </Menu>\n      </Header>\n      <Edit2D />\n      <Left />\n    </Layout>\n  )\n};\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}